name: Backend Continuous Integration
'on':
  workflow_dispatch: null
  pull_request:
    branches:
      - main
    paths:
      - backend/**
jobs:
  lint-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'
          cache: pipenv
      - name: Run pipenv
        uses: tiagovrtr/actions-pipenv@v1
        with:
          pipenv-version: v2023.10.24
      - name: Pipenv install
        run: cd backend && pipenv install -d
      - name: Run lint
        run: cd backend && pipenv run lint
  test-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'
          cache: pipenv
      - name: Run pipenv
        uses: tiagovrtr/actions-pipenv@v1
        with:
          pipenv-version: v2023.10.24
      - name: Pipenv install
        run: cd backend && pipenv install
      - name: Run test
        run: cd backend && pipenv run test
  build-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'
          cache: pipenv
      - name: Run pipenv
        uses: tiagovrtr/actions-pipenv@v1
        with:
          pipenv-version: v2023.10.24
      - name: Pipenv install
        run: cd backend && pipenv install
      - name: Run test
        run: cd backend && pipenv run test
